
{% extends 'website/base.html' %}
{% include 'website/messages.html' %}
{% load static %}
{% block content %}<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <title> رسائلي | صارحني </title>
    <link href="{% static 'assets/style.css' %}" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{% static 'assets/icofont.min.css' %}">
    <script src="{% static 'assets/js/jquery.min.js' %}"></script>
    <script src="{% static 'assets/js/socket.io/4.3.1/socket.io.min.js' %}"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4704968227879779" crossorigin="anonymous"></script>
    <link rel="manifest" href="/manifest.json" />
    <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async></script>
    <script>
        var OneSignal = window.OneSignal || [];
        OneSignal.push(function() {
            OneSignal.init({
                appId: "df5443ff-85d4-405d-ac33-406027472e69",
            });
        });
        window.OneSignal = window.OneSignal || [];
        OneSignal.push(function() {
            OneSignal.on("subscriptionChange", function(isSubscribed) {
                if (isSubscribed) {
                    updatepush();
                }
            });
        });
        updatepush();

        function updatepush() {
            OneSignal.push(function() {
                OneSignal.getUserId(function(userId) {});

                OneSignal.getUserId().then(function(userId) {
                    if (userId !== 'null') {

                        var xhttp = new XMLHttpRequest();
                        xhttp.open("GET", "ajax/user/push.html?action=webpush&token=" + userId, true);
                        xhttp.send();
                    }
                });
            });
        }
    </script>
</head>

<body id="body">


    <center>
        <div id="top">
            <img onclick="askimg();" style="margin-top: 10px;overflow:hidden;border-radius:50%;border: 3px #ffffff4a solid;" src="https://static.sarhne.com/sarhne.com/profile_photo/53977590013189.jpg?t=1694118733" onerror="this.onerror=null;this.src='https://www.sarhne.com/assets/img/logo-150.jpg';"
                width="111" height="111" alt="#">
            <div class="user">
                <h3 dir="rtl">
                    {{user.username}}
                </h3>
            </div>
            <span class="wh" id="sarhne-link"> {{domain}}{{user.profile.slug}} </span>
            <div id="sarhne-input" class="input-group input-group-icon" dir="ltr" style="width:90%;max-width:550px;margin: 0px 5px 5px 5px;text-align:center;display:none;">
                <input onclick="select_all(this)" type="text" id="slink" style value="{{domain}}/profile/{{user.profile.slug}}" />
                <div class="input-icon"><i><img src="{% static 'assets/img/link-form.svg' %}" width="20" alt="*"></i></div>
            </div>
            <span class="normal_text">شارك الرابط وابدأ بتلقي الرسائل والصراحات </span>
            <span dir="rtl" style="display: block;">
<a onclick="copylink();" class="userbutton" style="background-color:#3282b8;width:90px;border:0;"><img src="{% static 'assets/img/clipboard.svg' %}" width="20" height="auto" style="vertical-align:middle;padding-right:5px;padding-top:3px;" alt="#"> نسخ </a>
<a id="share-btn" class="userbutton" style="background-color:#3282b8;width:90px;"><img src="{% static 'assets/img/sharethis-logo.svg' %}" width="20" height="auto" style="vertical-align:middle;padding-right:5px;padding-top:3px;" alt="#"> مشاركة </a>
<div class="overlayb" style="display:none;" id="overlay"></div>
<div class="share-btn clicked" id="sharedialog" style="display:none;" dir="rtl">
<span class="cta">مشاركة</span>
            <div class="close">X</div>
            <ul class="social">
                <center>
                    <a href="https://www.facebook.com/sharer.php?u=http://53977590013189.sarhne.com" class="userbutton" style="background-color:#3c5898;width:90%;margin-bottom:5px;"> Facebook <img src="{% static 'assets/img/share-facebook.svg' %}" width="20" height="auto" style="vertical-align:middle;padding-right:5px;padding-top:3px;" alt="#"></a>
                    <a href="https://wa.me/?text=%20أعطني%20رأيك%20عني%20بسرية%20تامة%20وصراحة%20http://53977590013189.sarhne.com" class="userbutton" style="background-color:#4FCE5D;width:90%;margin-bottom:5px;"> WhastApp <img src="{% static 'assets/img/share-whatsapp.svg' %}" width="20" height="auto" style="vertical-align:middle;padding-right:5px;padding-top:3px;" alt="#"> </a>
                    <a data-modal="open" class="userbutton" style="background-color:#3F729B;width:90%;margin-bottom:5px;"> Instagram <img src="{% static 'assets/img/share-insta.svg' %}" width="20" height="auto" style="vertical-align:middle;padding-right:5px;padding-top:3px;" alt="#"></a>
                    <a href="https://twitter.com/intent/tweet?text= أعطني رأيك عني بسرية تامة وصراحة&hashtags=صارحني&url=http://53977590013189.sarhne.com" class="userbutton" style="background-color:#55ACEE;width:90%;margin-bottom:5px;"> Twitter <img src="{% static 'assets/img/share-twitter.svg' %}" width="20" height="auto" style="vertical-align:middle;padding-right:5px;padding-top:3px;" alt="#"> </a>
                </center>
            </ul>
        </div>
        <div class="modal-wrapper" data-modal="wrapper">
            <div class="modal-content">
                <div class="relative">
                    <button data-modal="close" class="btn-modal btn-close">&times;</button>
                    <div class="text">
                        <p><img src="{% static 'assets/img/instaa.jpg' %}" width="100%"></p>
                    </div>
                </div>
            </div>
        </div>
        <a href="{% static 'help.html' %}" class="userbutton" style="background-color:#3282b8;width:90px;">
<img src="{% static 'assets/img/question.svg' %}" width="20" height="auto" style="vertical-align:middle;padding-right:5px;padding-top:3px;" alt="#"> تعليمات </a>
        </span>
        <br>
        </div>
        <div id="myModal" class="modal">

            <div class="modal-content">
                <span class="closem">&times;</span>
                <p>
                    <img src="{% static 'assets/img/instaa.jpg' %}" width="100%">
                </p>
            </div>
        </div>
        <div class="soical_icon_messages_div">
            <div class style="direction: rtl;font-size:14px;">
                شارك الرابط الخاص بك بنقرة واحدة
            </div>
            <a href="https://www.facebook.com/sharer.php?u=http://53977590013189.sarhne.com">
<img src="https://www.sarhne.com/assets/img/social/facebook_icon.svg" class="soical_icon_messages">
</a>
            <a href="https://www.sarhne.com/blog/how-to-put-sarhne-link-on-snapchat-story">
<img src="https://www.sarhne.com/assets/img/social/snapchat_icon.svg" class="soical_icon_messages">
</a>
            <a href="https://twitter.com/intent/tweet?text= أعطني رأيك عني بسرية تامة وصراحة&hashtags=صارحني&url=http://53977590013189.sarhne.com">
<img src="https://www.sarhne.com/assets/img/social/twitter_icon.svg" class="soical_icon_messages">
</a>
            <img id="myBtn" src="https://www.sarhne.com/assets/img/social/instagram_icon.svg" class="soical_icon_messages">
            <a href="https://wa.me/?text=%20أعطني%20رأيك%20عني%20بسرية%20تامة%20وصراحة%20 http://53977590013189.sarhne.com">
<img src="https://www.sarhne.com/assets/img/social/wa_icon.svg" class="soical_icon_messages">
</a>
            <a href="https://t.me/share/url?url=?text=%20أعطني%20رأيك%20عني%20بسرية%20تامة%20وصراحة%20 http://53977590013189.sarhne.com">
<img src="https://www.sarhne.com/assets/img/social/telegram.png" class="soical_icon_messages" style="border-radius: 12px;">
</a>
            <a href="https://www.sarhne.com/blog/share_sarhne_link_to_tiktok">
<img src="https://www.sarhne.com/assets/img/social/tiktok.svg" class="soical_icon_messages">
</a>
        </div>
        <script>
            // Get the modal
            var modal = document.getElementById("myModal");

            // Get the button that opens the modal
            var btn = document.getElementById("myBtn");

            // Get the <span> element that closes the modal
            var span = document.getElementsByClassName("closem")[0];

            // When the user clicks the button, open the modal 
            btn.onclick = function() {
                modal.style.display = "block";
            }

            // When the user clicks on <span> (x), close the modal
            span.onclick = function() {
                modal.style.display = "none";
            }

            // When the user clicks anywhere outside of the modal, close it
            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }
        </script>
        <div id="center" style="margin-top:10px;">
            <style>
                .tabBar {
                    display: table;
                    table-layout: fixed;
                    box-sizing: border-box;
                    width: 100%;
                    border-radius: 7px;
                    margin-bottom: 0;
                    background-color: #00000017;
                    overflow: hidden;
                    direction: rtl;
                }

                .tabBar a.active {
                    color: #FFF;
                    background-color: #2D2F31;
                    border-bottom: 2px #2D2F31C9 solid;
                }

                .tabBar a {
                    display: table-cell;
                    vertical-align: middle;
                    text-align: center;
                    font-size: 12px;
                    line-height: 22px;
                    padding: 8px;
                    color: #2D2F31C9;
                }
            </style>
            <style>
                /* The Modal (background) */

                .modal {
                    display: none;
                    /* Hidden by default */
                    position: fixed;
                    /* Stay in place */
                    z-index: 1;
                    /* Sit on top */
                    padding-top: 100px;
                    /* Location of the box */
                    left: 0;
                    top: 0;
                    width: 100%;
                    /* Full width */
                    height: 100%;
                    /* Full height */
                    overflow: auto;

                    background-color: rgb(0, 0, 0);

                    background-color: rgba(0, 0, 0, 0.4);

                }



                .modal-content {
                    background-color: #fefefe;
                    margin: auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }

                /* The Close Button */

                .closem {
                    color: #aaaaaa;
                    float: right;
                    font-size: 28px;
                    font-weight: bold;
                }

                .closem:hover,
                .closem:focus {
                    color: #000;
                    text-decoration: none;
                    cursor: pointer;
                }
            </style>

   {% with type_of_viwe='message' %}
            <div class="tabBar">
         
            <a onclick="One();tabclick('my_messages.html');" id="my_messages" class="active">
<span class="f12"><i class="icofont-ui-messaging" style="font-size: 15px;"></i> رسائل واردة </span>
</a>
                <a onclick="Two();tabclick('fav.html');" id="fav" class>
<span class="f12"><i class="icofont-favourite" style="font-size: 15px;"></i> المفضلة </span>
</a>
                <a onclick="Three();tabclick('my_send.html');" id="my_send" class>
<span class="f12"> مرسلة <i class="icofont-paper-plane" style="font-size: 15px;"></i> </span>
</a>
            </div>
            

            <div id="tab_contant"></div>
            <section id="ajax_wait">
                <div class="hr"></div>
                <h5>
                    الرجاء الأنتظار
                </h5>
                <div class="loader"></div>
                <h3>
                    جارٍ جلب البيانات
                </h3>
                <div class="hr"></div>
            </section>
            <!-- start messeges -->
            

            <div id="importedContentContainer">
                <!-- The fetched HTML content will be inserted here -->
            </div>
            
            <script>
                function One() {
                    fetch('{{domain}}/my_messages')  // Replace with the correct URL
                    .then(response => response.text())
                    .then(html => {
                        // Insert the HTML content into the specified container
                        document.getElementById('importedContentContainer').innerHTML = html;
                    })
                    .catch(error => console.error('Error fetching external content:', error));
                }
                function Two() {
                    fetch('{{domain}}/fav')  // Replace with the correct URL
                    .then(response => response.text())
                    .then(html => {
                        // Insert the HTML content into the specified container
                        document.getElementById('importedContentContainer').innerHTML = html;
                    })
                    .catch(error => console.error('Error fetching external content:', error));
                }
                function Three() {
                    fetch('{{domain}}/my_send')  // Replace with the correct URL
                    .then(response => response.text())
                    .then(html => {
                        // Insert the HTML content into the specified container
                        document.getElementById('importedContentContainer').innerHTML = html;
                    })
                    .catch(error => console.error('Error fetching external content:', error));
                }
                
 
                
            </script>


            
    
            

<!-- end messeges -->
{% endwith %}
        </div> 
        <br>
        

 

       

        <div class="box2">
            <div class="rule">
                <div class="line">
                    <div></div>
                </div>
                <div class="words"> لاتفوت الفرصة 😍 </div>
                <div class="line">
                    <div></div>
                </div>
            </div>
            <div id="random-app">
                <center>
                    <style>
                        .boxapp {
                            max-width: 550px;
                            background-color: #F7F7F7;
                            margin: 5px 5px 15px;
                            padding: 5px;
                            border-radius: 5px;
                            position: relative;
                        }

                        .apphr {
                            height: 1px;
                            background-color: #F7F7F7;
                            margin: 2px;
                            display: block;
                            width: 100%;
                            clear: both
                        }

                        #narrow {
                            float: right;
                            width: 100px
                        }

                        #wide {
                            float: left;
                            width: calc(100% - 113px);
                            color: #000;
                            text-align: right
                        }

                        .title {
                            font-size: 17px;
                            font-weight: 700
                        }

                        .contant {
                            font-size: 12px
                        }

                        .apptextBottom {
                            vertical-align: bottom;
                            text-align: left;
                            padding-left: 1px;
                            font-size: 12px;
                            color: #4E4758;
                            position: absolute;
                            bottom: 0;
                        }

                        .img {
                            border: 2px solid #ccc;
                            border-radius: 50%
                        }
                    </style>
                    <div class="boxapp" onclick="javascript:location.href='https://sarahah.pro/?op=openchrome'">
                        <div class="apphr"> </div>
                        <div id="parent">
                            <div id="wide"><span class="title"> صراحة - sarahah </span><br>
                                <span class="contant"> صراحة الجديد رسائل سرية مع ميزات جديدة حصرية </span> <br>
                                <div class="apptextBottom"> مستخدمون : +100,000 </div>
                            </div>
                            <div id="narrow">
                                <img src="https://www.sarhne.com/sarahahpro.jpg" class="img" alt="#" width="100" height="100">
                            </div>
                        </div>
                        <div class="apphr"> </div>
                    </div>
                    <div class="boxapp" onclick="javascript:location.href='https://play.google.com/store/apps/details?id=com.sournet.app'">
                        <div class="apphr"> </div>
                        <div id="parent">
                            <div id="wide"><span class="title"> شات صارحني </span><br>
                                <span class="contant"> تعرف على مستخدمين موقع صارحني من خلال غرف الدردشة </span> <br>
                                <div class="apptextBottom"> مستخدمون : +5000,000 </div>
                            </div>
                            <div id="narrow">
                                <img src="https://play-lh.googleusercontent.com/WwP3LfDOiX41sDzjrjnHHA0RtNvv3PGeKJTljOD9_TpzsK6p_bGbl4hbs8o4ckOy7Wmc=w480-h960" class="img" alt="#" width="100" height="100">
                            </div>
                        </div>
                        <div class="apphr"> </div>
                    </div>
                </center>
            </div>
            <div class="hr"></div>
        </div>
        <script>
            function showad(ad) {
                Android.showad(ad);
            }
        </script>
        <br>
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

        <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4704968227879779" data-ad-slot="4883306843" data-ad-format="link" data-full-width-responsive="true"></ins>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
        </script> <br>
        <script>
            function open_link(link) {
                if (link == '#') {

                } else {
                    window.location.href = link;
                }

            }

            tabclick('my_messages.html');
            var sort_msg = 'new';

            function tabclick(tabid) {
                $('#tab_contant').html(' ');
                $('#ajax_wait').show();
                $.ajax({
                    type: 'POST',
                    url: 'ajax/messages/' + tabid,
                    data: 'sort=' + sort_msg,
                    success: function(res) {
                        $('#ajax_wait').hide();
                        $('#tab_contant').html(res);
                    },
                    error: function(request, status, error) {
                        $('#ajax_wait').hide();
                        server_erorr();
                    }
                });

                if (tabid.includes('my_messages.html')) {
                    $('#my_messages').removeClass("active");
                    $('#my_send').removeClass("active");
                    $('#fav').removeClass("active");
                    $('#my_messages').addClass("active");
                } else if (tabid.includes('my_send.html')) {
                    $('#my_messages').removeClass("active");
                    $('#my_send').removeClass("active");
                    $('#fav').removeClass("active");
                    $('#my_send').addClass("active");
                } else if (tabid.includes('fav.html')) {
                    $('#my_messages').removeClass("active");
                    $('#my_send').removeClass("active");
                    $('#fav').removeClass("active");
                    $('#fav').addClass("active");
                }



            }







            $('#share-btn').click(function() {
                document.getElementById("sharedialog").style.display = "block";
                document.getElementById("overlay").style.display = "block";

            });

            $('.close').click(function(e) {
                document.getElementById("sharedialog").style.display = "none";
                document.getElementById("overlay").style.display = "none";
            });

            function screenClass() {
                if ($(window).innerWidth() > 1200) {
                    $('.tabs').hide();
                    $('.nav').show();
                } else {
                    $('.nav').hide();
                    $('.tabs').show();
                }
            }
            screenClass();
            $(window).bind('resize', function() {
                screenClass();
            });


            var Modal = (function() {

                var modalOpen = document.querySelector('[data-modal="open"]'),
                    modalClose = document.querySelector('[data-modal="close"]'),
                    modalWrapper = document.querySelector('[data-modal="wrapper"]');

                return {
                    init: function() {
                        this.abrir();
                        this.fechar();
                    },

                    abrir: function() {
                        modalOpen.onclick = function(e) {
                            e.preventDefault;
                            document.getElementById("sharedialog").style.display = "none";
                            document.getElementById("overlay").style.display = "none";
                            modalWrapper.classList.add("modal-opened");
                        }
                    },

                    fechar: function() {
                        modalClose.onclick = function(e) {
                            e.preventDefault;
                            modalWrapper.classList.remove("modal-opened");
                        }
                    }
                }
            }());

            Modal.init();


            var show_coy_link = '0';

            function copylink() {
                if (show_coy_link == '0') {
                    document.getElementById("sarhne-link").style.display = "none";
                    document.getElementById("sarhne-input").style.display = "block";
                    $("#top").height(390);
                    alerty.alert(' تم اظهار صندوق نسخ الرابط الخاص بك , الخطوة التالية انقر فوق النص المحدد واختر نسخ , ثم اذهب الى اي تطبيق ترغب بمشاركة الرابط الخاص بك واختر لصق ', {
                        title: 'تعليمات',
                    }, function() {
                        $('#slink').select();
                        $('#slink').focus();
                        $('#slink').prop('readonly', true);
                    }, function() {})
                    show_coy_link = '1';
                } else {
                    document.getElementById("sarhne-link").style.display = "block";
                    document.getElementById("sarhne-input").style.display = "none";
                    $("#top").height(365);
                    show_coy_link = '0';
                }

            }


            function replay(id) {

                alerty.prompt('أكتب رد على هذه الرسالة', {
                        inputType: 'text',
                        inputPlaceholder: 'ردك هنا',
                        inputValue: '',
                        inputDir: 'rtl'
                    },
                    function(value) {

                        if (value) {

                            $("#replay_msg_" + id).html('<img src="assets/img/ajax_clock_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;"> انتظر ');

                            $.ajax({
                                type: 'POST',
                                url: 'ajax/messages/replay_msg.html',
                                data: 'msg_id=' + id + '&replay_msg=' + value,
                                success: function(res) {
                                    if (res.includes("true")) {
                                        alerty.alert(' تم أضافة الرد بنجاح سيشاهد الرد زوار الرابط الخاص بك أضغط موافق ليتم تحديث الصفحة ', {
                                                title: 'صارحني',
                                            },
                                            function() {
                                                window.location.replace("messages.html");
                                                try {
                                                    setcanback('alerty');
                                                } catch (err) {}
                                            })
                                    } else {
                                        $("#replay_msg_" + id).html('<img src="assets/img/ajax_err_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;">');
                                        server_erorr();
                                    }


                                },
                                error: function(request, status, error) {
                                    $("#replay_msg_" + id).html('<img src="assets/img/ajax_err_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;">');
                                    server_erorr();
                                }
                            });

                        }
                    },
                    function() {
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    })
            }





            function edit_replay(id) {

                alerty.prompt('تعديل الرد على هذه الرسالة', {
                        inputType: 'text',
                        inputPlaceholder: 'أكتب هنا',
                        inputValue: '',
                        inputDir: 'rtl'
                    },
                    function(value) {

                        if (value) {

                            document.getElementById("edit_replay_" + id).src = "assets/img/ajax_clock_black.svg";

                            $.ajax({
                                type: 'POST',
                                url: 'ajax/messages/replay_msg.html',
                                data: 'msg_id=' + id + '&replay_msg=' + value,
                                success: function(res) {
                                    if (res.includes("true")) {
                                        alerty.alert(' تم تعديل الرد بنجاح أضغط موافق ليتم تحديث الصفحة ', {
                                                title: 'صارحني',
                                            },
                                            function() {
                                                window.location.replace("messages.html");
                                                try {
                                                    setcanback('alerty');
                                                } catch (err) {}
                                            })
                                    } else {
                                        document.getElementById("edit_replay_" + id).src = "assets/img/ajax_err_black.svg";

                                        server_erorr();
                                    }


                                },
                                error: function(request, status, error) {
                                    document.getElementById("edit_replay_" + id).src = "assets/img/ajax_err_black.svg";
                                    server_erorr();
                                }
                            });

                        }
                    },
                    function() {
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    })
            }




            function new_update() {

                alerty.confirm(
                    ' تستخدم اصدار قديم من صارحني من فضلك حدث التطبيق لأخر اصدار من متجر جوجل بلاي؟  ', {
                        title: ' تأكيد ',
                        cancelLabel: 'لا',
                        okLabel: 'نعم'
                    },
                    function() {
                        window.location.href = "https://play.google.com/store/apps/details?id=app.sarhne.com";
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    },
                    function() {

                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    })
                try {
                    setcanback('alerty');
                } catch (err) {}
            }

            function showmsg(id) {
                alerty.confirm(
                    ' هل انت متأكد من أضهار هذه الرسالة الى العامة؟  ستكون متاحة للمشاهدة على الرابط الخاص بك', {
                        title: ' تأكيد ',
                        cancelLabel: 'لا',
                        okLabel: 'نعم'
                    },
                    function() {

                        $("#show_msg_" + id).html('<img src="assets/img/ajax_clock_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;"> انتظر ');

                        $.ajax({
                            type: 'POST',
                            url: 'ajax/messages/show_msg.html',
                            data: 'msg_id=' + id,
                            success: function(res) {
                                if (res.includes("true")) {
                                    alerty.alert(' تم أضهار هذه الرسالة  أضغط موافق ليتم تحديث الصفحة ', {
                                            title: 'صارحني',
                                        },
                                        function() {
                                            window.location.replace("messages.html");
                                            try {
                                                setcanback('alerty');
                                            } catch (err) {}
                                        })
                                    try {
                                        setcanback('alerty');
                                    } catch (err) {}
                                } else {
                                    $("#show_msg_" + id).html('<img src="assets/img/ajax_err_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;">');
                                }
                            },
                            error: function(request, status, error) {
                                $("#show_msg_" + id).html('<img src="assets/img/ajax_err_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;">');
                                server_erorr();
                            }
                        });




                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    },
                    function() {
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    })
            }


            function hidemsg(id) {
                alerty.confirm(
                    ' هل انت متأكد من أخفاء هذه الرسالة من العرض على الرابط الخاص بك؟  ', {
                        title: ' تأكيد ',
                        cancelLabel: 'لا',
                        okLabel: 'نعم'
                    },
                    function() {

                        $("#show_msg_" + id).html('<img src="assets/img/ajax_clock_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;"> انتظر ');

                        $.ajax({
                            type: 'POST',
                            url: 'ajax/messages/hide_msg.html',
                            data: 'msg_id=' + id,
                            success: function(res) {
                                if (res.includes("true")) {
                                    alerty.alert(' تم أخفاء هذه الرسالة عن العرض , أضغط موافق ليتم تحديث الصفحة ', {
                                            title: 'صارحني',
                                        },
                                        function() {
                                            window.location.replace("messages.html");
                                            try {
                                                setcanback('alerty');
                                            } catch (err) {}
                                        })
                                    try {
                                        setcanback('alerty');
                                    } catch (err) {}
                                } else {
                                    $("#show_msg_" + id).html('<img src="assets/img/ajax_err_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;">');
                                }
                            },
                            error: function(request, status, error) {
                                $("#show_msg_" + id).html('<img src="assets/img/ajax_err_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;">');
                                server_erorr();
                            }
                        });




                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    },
                    function() {
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    })
            }




            function delsend(id) {
                alerty.confirm(
                    ' سيتم حذف هذه المصارحة من رسائل المستلم هل ترغب بالأستمرار ؟  ', {
                        title: ' تأكيد ',
                        cancelLabel: 'لا',
                        okLabel: 'نعم'
                    },
                    function() {
                        $("#del_send_" + id).html('<img src="assets/img/ajax_clock_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;"> انتظر ');
                        $.ajax({
                            type: 'POST',
                            url: 'ajax/messages/del_send.html',
                            data: 'msg_id=' + id,
                            success: function(res) {
                                if (res.includes("true")) {
                                    $('#' + id).hide(1000);
                                    nativeToast({
                                        message: ' تم أزالة هذه المصارحة لديك ولدى المستلم ',
                                        type: 'info',
                                        position: 'top'
                                    })
                                } else {
                                    $("#del_send_" + id).html('<img src="assets/img/ajax_err_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;">');
                                }
                            },
                            error: function(request, status, error) {
                                $("#del_send_" + id).html('<img src="assets/img/ajax_err_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;">');
                                server_erorr();
                            }
                        });
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    },
                    function() {
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    })
            }






            function delmsg(id) {
                alerty.confirm(
                    ' هل انت متأكد من حذف هذه الرسالة ؟  ', {
                        title: ' تأكيد ',
                        cancelLabel: 'لا',
                        okLabel: 'نعم'
                    },
                    function() {
                        $("#del_" + id).html('<img src="assets/img/ajax_clock_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;"> انتظر ');
                        $.ajax({
                            type: 'POST',
                            url: 'ajax/messages/del_msg.html',
                            data: 'msg_id=' + id,
                            success: function(res) {
                                if (res.includes("true")) {
                                    $("#dl-" + id).hide(1000);
                                } else {
                                    $("#del_" + id).html('<img src="assets/img/ajax_err_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;">');
                                }
                            },
                            error: function(request, status, error) {
                                $("#del_" + id).html('<img src="assets/img/ajax_err_white.svg" width="20" height="auto" alt="#" style="vertical-align:middle;">');
                                server_erorr();
                            }
                        });
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    },
                    function() {
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    })
            }


            function del_all_messges(id) {
                alerty.confirm(
                    ' هل انت متأكد من حذف كل الرسائل لايمكن التراجع عن هذا القرار ؟  ', {
                        title: ' تأكيد ',
                        cancelLabel: 'لا',
                        okLabel: 'نعم'
                    },
                    function() {
                        $('#del_all_messges').html('<img src="assets/img/ajax_clock_black.svg" width="20">');
                        $.ajax({
                            type: 'GET',
                            url: 'ajax/messages/del_all_messges.html',
                            // data:'msg_id='+id,
                            success: function(res) {
                                if (res.includes("true")) {

                                    alerty.alert(' تم حذف كل الرسائل بنجاح , أضغط موافق ليتم تحديث الصفحة ', {
                                            title: 'صارحني',
                                        },
                                        function() {
                                            window.location.replace("messages.html");
                                            try {
                                                setcanback('alerty');
                                            } catch (err) {}
                                        })
                                    try {
                                        setcanback('alerty');
                                    } catch (err) {}


                                } else {
                                    $('#del_all_messges').html('<img src="assets/img/ajax_err_black.svg" width="20">');

                                }
                            },
                            error: function(request, status, error) {
                                $('#del_all_messges').html('<img src="assets/img/ajax_err_black.svg" width="20">');
                                server_erorr();
                            }
                        });
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    },
                    function() {
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    })
            }


            function delreplay(id) {
                alerty.confirm(
                    ' هل انت متأكد من حذف هذه الرسالة ؟  ', {
                        title: ' تأكيد ',
                        cancelLabel: 'لا',
                        okLabel: 'نعم'
                    },
                    function() {
                        document.getElementById("del_replay_" + id).src = "assets/img/ajax_clock_black.svg";
                        $.ajax({
                            type: 'POST',
                            url: 'ajax/messages/del_replay.html',
                            data: 'msg_id=' + id,
                            success: function(res) {
                                if (res.includes("true")) {

                                    alerty.alert(' تم حذف الرد بنجاح , أضغط موافق ليتم تحديث الصفحة ', {
                                            title: 'صارحني',
                                        },
                                        function() {
                                            window.location.replace("messages.html");
                                            try {
                                                setcanback('alerty');
                                            } catch (err) {}
                                        })
                                    try {
                                        setcanback('alerty');
                                    } catch (err) {}


                                } else {
                                    document.getElementById("del_replay_" + id).src = "assets/img/ajax_err_black.svg";
                                }
                            },
                            error: function(request, status, error) {
                                document.getElementById("del_replay_" + id).src = "assets/img/ajax_err_black.svg";
                                server_erorr();
                            }
                        });
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    },
                    function() {
                        try {
                            setcanback('alerty');
                        } catch (err) {}
                    })
            }



            function fav(id) {
                document.getElementById("fav_" + id).src = "assets/img/loader.svg";


                $.ajax({
                    type: 'POST',
                    url: 'ajax/messages/set_fav.html',
                    data: 'msg_id=' + id,
                    success: function(res) {

                        if (res.includes("true")) {
                            document.getElementById("fav_" + id).src = "{% static 'assets/img/stary.svg' %}";
                            nativeToast({
                                message: ' تم أضافة هذه الرسالة الى المفضلة ',
                                type: 'success',
                                position: 'center'
                            })

                        } else if (res.includes("false")) {
                            document.getElementById("fav_" + id).src = "assets/img/star.svg";
                            nativeToast({
                                message: ' تم أزالة هذه الرسالة من المفضلة ',
                                type: 'success',
                                position: 'center'
                            })
                        }


                    },
                    error: function(request, status, error) {
                        document.getElementById("fav_" + id).src = "assets/img/ajax_err.svg";
                        server_erorr();
                    }
                });







            }


            try {
                clearhistory();
            } catch (err) {

            }




            function clearhistory() {
                Android.clearhistory();
            }






            var connected = false;
            const RETRY_INTERVAL = 2500;
            var timeout;
            var socket = io.connect('https://ws.sarhne.com/', {
                transports: ['websocket']
            });

            socket.on('connect', function() {
                connected = true;
                clearTimeout(timeout);
                socket.emit('join_update', {
                    room: '53977590013189'
                });
                console.log("connects");
            });

            socket.on('disconnect', function() {
                connected = false;
                retryConnectOnFailure(RETRY_INTERVAL);
            });

            var retryConnectOnFailure = function(retryInMilliseconds) {
                setTimeout(function() {
                    if (!connected) {
                        socket.connect();
                        retryConnectOnFailure(retryInMilliseconds);
                    }
                }, retryInMilliseconds);
            }


            socket.on('get_update', function(data) {
                var ty = data.ty;
                if (ty.includes("new_msg")) {

                    alerty.confirm(
                        ' وصلتك رسالة جديدة الى حسابك , هل ترغب بتحديث الصفحة لمشاهدتها ؟  ', {
                            title: ' تأكيد ',
                            cancelLabel: 'لا',
                            okLabel: 'نعم'
                        },
                        function() {
                            location.href = 'https://www.sarhne.com/messages.html';
                            try {
                                setcanback('alerty');
                            } catch (err) {}
                        },
                        function() {
                            try {
                                setcanback('alerty');
                            } catch (err) {}
                        })

                }


            })









            (function() {

                var dardacham = $(".fadingm");
                var dardachaIndexm = -1;

                function showNextm() {
                    ++dardachaIndexm;
                    dardacham.eq(dardachaIndexm % dardacham.length)
                        .fadeIn(1000)
                        .delay(1000)
                        .fadeOut(1000, showNextm);
                }

                showNextm();

            })();
        </script>
        <div class="box" style="padding:0;direction: rtl;line-height: 40px;display:none;">
            <br> لا تدع الفرصة تفوتك! انضم إلى صراحة الجديدة واستمتع بتجربة فريدة ومميزة.
            <br> الآن يمكنك الاستمتاع بتجربة فريدة ومثيرة بفضل:
            <br> 1️⃣ الرد المحادثة الخاصة على الرسائل، بدون أن تظهر للجميع.
            <br> 2️⃣ النظام الجديد للمتابعة، حيث يمكنك عرض رسائلك فقط للمتابعين المحددين.
            <br> 3️⃣ حساب خاص لإدارة طلبات المتابعة والمزيد من التحكم في محتواك.
            <br> 4️⃣ تنبيهات الواتساب للرسائل الواردة، لتتلقى كل رسالة بسرعة ودون أن تفوتك.
            <br> 5️⃣ إمكانية إرسال ما يصل إلى 3 صور في رسالة واحدة أو رد واحد.
            <br> سارع وقم بزيارة هذا الرابط لتسجيل حسابك واكتشاف المزيد: 👇
            <a href="https://sarahah.pro/?op=openchrome"> www.sarahah.pro </a>
            <br>
            <a href="https://sarahah.pro/?op=openchrome"><img src="https://sarahah.pro/assets/img/uploads/og_image.png" width="100%"></a>
        </div>
        <script src="assets/js/func.js?v=1598020502"></script>
        <script src="assets/js/alerty.js?v2"></script>
        <script src="assets/js/toast.js"></script>


        <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZRDMJGQHJC"></script>
        <script>
            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }
            gtag('js', new Date());

            gtag('config', 'G-ZRDMJGQHJC');
        </script>
        <script defer src="https://static.cloudflareinsights.com/beacon.min.js/v84a3a4012de94ce1a686ba8c167c359c1696973893317" integrity="sha512-euoFGowhlaLqXsPWQ48qSkBSCFs3DPRyiwVu3FjR96cMPx+Fr+gpWRhIafcHwqwCqWS42RZhIudOvEI+Ckf6MA==" data-cf-beacon='{"rayId":"85f106ce3e430cf8","version":"2024.2.4","token":"218cd1753fe64a258e6d9b2b19630e7e"}'
            crossorigin="anonymous"></script>
</body>

</html>
{% endblock %} 